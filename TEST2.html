<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
<title>Median Sales Price CPI Adjusted</title>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://dimplejs.org/dist/dimple.v2.1.6.min.js"></script>

<style>
body {
    background-color: #E9EFF7;
}
#BarChart {    
    float: left;
    top:5px;
    right:8px;
    width: 100%;
	height: 450px;
	background-color: #E9EFF7;
}
.textclasshead {
  float: center;
  font-family: 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif;
    font-size: 14px;
	font-style: normal;
	font-variant: normal;
	font-weight: 500;
	line-height: 15.4px;
  text-align: center;
  color: #545454;
  }
  .textclass {
  float: left;
  font-family: sans-serif;
    font-size: 12px;
	font-style: normal;
	font-variant: normal;
	font-weight: 400;
	line-height: 18px;
  color: #545454;
  }
</style>
</head>
<body>
<div class="textclasshead"><strong>Median Single Family Sales Price 1995 - 2015, Adjusted for Inflation</strong></div><br>
<div class="textclass">The chart shown here displays the median sale price for Lexington and surrounding communities. Municipalities can be turned off by clicking the legend at the right. Hover over bars for more information about specific municipalities. All data derived from The Warren Group 2016.  </div> 
<div id="BarChart"></div><br>
<div class="textclass"; width="100%"; height="150px";><strong>Did You Know?</strong><br>Lexington’s housing circumstances are in some ways very comfortable compared both with other communities and with other periods, but at the same time those circumstances are very challenging by the same comparisons.  The Town has largely exhausted its vacant unprotected land supply (with less than 1,000 acres remaining), so the era of struggling to accommodate 400 or more new dwelling units in a year has gone by.  Both land development and a strong program of land conservation has resulted in striking reduction in the remaining building capacity of the Town.  Added housing now comes relatively slowly, but the demographic change that is transforming the Town is rapid and sharp.  Regional housing market forces have escalated housing prices with resulting rapid demographic change making Lexington a community highly stratified in income, with an older population in smaller households than is common in other communities.  Those socio-economic changes alter the community in ways made more difficult to address as a result of the Town’s now-modest growth potential.<br>This modest growth potential, due to the scarcity of buildable land under current zoning regulations, may contribute to a rise in pricing for new and existing homes in a manner that outpaces the metro-region.</div>
      <script type="text/javascript">
    var svg = dimple.newSvg("#chartContainer", 590, 400);
    d3.csv("C:\Users\dfields\Desktop\data.csv", function (data) {

      // Get a unique list of dates
      var months = dimple.getUniqueValues(data, "Date");

      // Set the bounds for the charts
      var row = 0,
          col = 0,
          top = 25,
          left = 60,
          inMarg = 15,
          width = 115,
          height = 90,
          totalWidth = parseFloat(svg.attr("width"));

      // Pick the latest 12 dates
      months = months.slice(months.length - 12);

      // Draw a chart for each of the 12 dates
      months.forEach(function (month) {
          
          // Wrap to the row above
          if (left + ((col + 1) * (width + inMarg)) > totalWidth) {
            row += 1;
            col = 0;
          }
          
          // Filter for the month in the iteration
          var chartData = dimple.filterData(data, "Date", month);
          
          // Use d3 to draw a text label for the month
          svg
            .append("text")
                .attr("x", left + (col * (width + inMarg)) + (width / 2))
                .attr("y", top + (row * (height + inMarg)) + (height / 2) + 12)
                .style("font-family", "sans-serif")
                .style("text-anchor", "middle")
                .style("font-size", "28px")
                .style("opacity", 0.2)
                .text(chartData[0].Month.substring(0, 3));
          
          // Create a chart at the correct point in the trellis
          var myChart = new dimple.chart(svg, chartData);
          myChart.setBounds(
            left + (col * (width + inMarg)),
            top + (row * (height + inMarg)),
            width,
            height);
          
          // Add x and fix ordering so that all charts are the same
          var x = myChart.addCategoryAxis("x", "Owner");
          x.addOrderRule(["Black Mesa", "Aperture", "Tyrell Corp",
            "Rekall", "MomCorp", "LexCorp", "Stark Ind", "Wayne Ent"]);
          
          // Add y and fix scale so that all charts are the same
          var y = myChart.addMeasureAxis("y", "Sales Value");
          y.overrideMax = 16000000;
          
          // Draw the bars.  Passing null here would draw all bars with
          // the same color.  Passing owner second colors by owner, which
          // is normally bad practice in a bar chart but works in a trellis.
          // Month is only passed here so that it shows in the tooltip.
          myChart.addSeries(["Month", "Owner"], dimple.plot.bar);

          // Draw the chart
          myChart.draw();

          // Once drawn we can access the shapes
          // If this is not in the first column remove the y text
          if (col > 0) {
            y.shapes.selectAll("text").remove();
          }
          // If this is not in the last row remove the x text
          if (row < 2) {
             x.shapes.selectAll("text").remove();
          }
          // Remove the axis labels
          y.titleShape.remove();
          x.titleShape.remove();

          // Move to the next column
          col += 1;

      }, this);
    });
  </script>
  </body>
  </html>